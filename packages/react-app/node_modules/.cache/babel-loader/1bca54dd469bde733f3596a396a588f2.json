{"ast":null,"code":"import { ethers } from \"ethers\";\nimport { addresses } from \"@gelato-krystal/contracts\";\nimport { getGasNowGasPrice } from \"../utils/helpers\";\nimport { getUserProxyContract, getGelatoKrystal } from \"./stateReads\";\nconst {\n  INSTA_INDEX_ADDR\n} = addresses;\nexport const deployProxyAction = async user => {\n  const signer = await user.getSigner();\n  const userAddr = await signer.getAddress();\n  const instaIndexContract = new ethers.Contract(INSTA_INDEX_ADDR, [\"function build(address _owner, uint accountVersion, address _origin) returns (address _account)\"], signer);\n  const gasPrice = await getGasNowGasPrice();\n  const tx = await instaIndexContract.build(userAddr, 1, userAddr, {\n    gasPrice: gasPrice\n  });\n  await tx.wait();\n};\nexport const userProxyCast = async (targets, datas, user, val = 0, gasLimit = 5000000) => {\n  const signer = await user.getSigner();\n  const userAddr = await signer.getAddress();\n  const userProxy = await getUserProxyContract(user);\n  const options = {\n    gasLimit: gasLimit,\n    value: val\n  };\n  const castTx = await userProxy.cast(targets, datas, userAddr, options);\n  await castTx.wait();\n};\nexport const submitOrder = async (user, inToken, outToken, delay, amountPerTrade, nTrades, minSlippage = 9001, maxSlippage = 9000, gasPriceCeil = 0) => {\n  const signer = await user.getSigner();\n  const userAddr = await signer.getAddress();\n  const gelatoKrystal = await getGelatoKrystal(user);\n  const options = {\n    gasPrice: ethers.utils.parseUnits(\"50\", \"gwei\")\n  };\n  const submitTx = await gelatoKrystal({\n    inToken,\n    outToken,\n    amountPerTrade,\n    nTrades,\n    minSlippage,\n    maxSlippage,\n    delay,\n    gasPriceCeil,\n    options\n  });\n  await submitTx.wait();\n};","map":{"version":3,"sources":["/Users/Hilmar/code/integrations/krystal/gelato-krystal/packages/react-app/src/services/stateWrites.js"],"names":["ethers","addresses","getGasNowGasPrice","getUserProxyContract","getGelatoKrystal","INSTA_INDEX_ADDR","deployProxyAction","user","signer","getSigner","userAddr","getAddress","instaIndexContract","Contract","gasPrice","tx","build","wait","userProxyCast","targets","datas","val","gasLimit","userProxy","options","value","castTx","cast","submitOrder","inToken","outToken","delay","amountPerTrade","nTrades","minSlippage","maxSlippage","gasPriceCeil","gelatoKrystal","utils","parseUnits","submitTx"],"mappings":"AAAA,SAASA,MAAT,QAAuB,QAAvB;AACA,SAASC,SAAT,QAA0B,2BAA1B;AACA,SAASC,iBAAT,QAAkC,kBAAlC;AACA,SAASC,oBAAT,EAA+BC,gBAA/B,QAAuD,cAAvD;AAEA,MAAM;AAAEC,EAAAA;AAAF,IAAuBJ,SAA7B;AAEA,OAAO,MAAMK,iBAAiB,GAAG,MAAOC,IAAP,IAAgB;AAC/C,QAAMC,MAAM,GAAG,MAAMD,IAAI,CAACE,SAAL,EAArB;AACA,QAAMC,QAAQ,GAAG,MAAMF,MAAM,CAACG,UAAP,EAAvB;AACA,QAAMC,kBAAkB,GAAG,IAAIZ,MAAM,CAACa,QAAX,CACzBR,gBADyB,EAEzB,CACE,iGADF,CAFyB,EAKzBG,MALyB,CAA3B;AAOA,QAAMM,QAAQ,GAAG,MAAMZ,iBAAiB,EAAxC;AACA,QAAMa,EAAE,GAAG,MAAMH,kBAAkB,CAACI,KAAnB,CAAyBN,QAAzB,EAAmC,CAAnC,EAAsCA,QAAtC,EAAgD;AAC/DI,IAAAA,QAAQ,EAAEA;AADqD,GAAhD,CAAjB;AAGA,QAAMC,EAAE,CAACE,IAAH,EAAN;AACD,CAfM;AAiBP,OAAO,MAAMC,aAAa,GAAG,OAC3BC,OAD2B,EAE3BC,KAF2B,EAG3Bb,IAH2B,EAI3Bc,GAAG,GAAG,CAJqB,EAK3BC,QAAQ,GAAG,OALgB,KAMxB;AACH,QAAMd,MAAM,GAAG,MAAMD,IAAI,CAACE,SAAL,EAArB;AACA,QAAMC,QAAQ,GAAG,MAAMF,MAAM,CAACG,UAAP,EAAvB;AACA,QAAMY,SAAS,GAAG,MAAMpB,oBAAoB,CAACI,IAAD,CAA5C;AACA,QAAMiB,OAAO,GAAG;AACdF,IAAAA,QAAQ,EAAEA,QADI;AAEdG,IAAAA,KAAK,EAAEJ;AAFO,GAAhB;AAIA,QAAMK,MAAM,GAAG,MAAMH,SAAS,CAACI,IAAV,CAAeR,OAAf,EAAwBC,KAAxB,EAA+BV,QAA/B,EAAyCc,OAAzC,CAArB;AACA,QAAME,MAAM,CAACT,IAAP,EAAN;AACD,CAhBM;AAkBP,OAAO,MAAMW,WAAW,GAAG,OACzBrB,IADyB,EAEzBsB,OAFyB,EAGzBC,QAHyB,EAIzBC,KAJyB,EAKzBC,cALyB,EAMzBC,OANyB,EAOzBC,WAAW,GAAG,IAPW,EAQzBC,WAAW,GAAG,IARW,EASzBC,YAAY,GAAG,CATU,KAUtB;AACH,QAAM5B,MAAM,GAAG,MAAMD,IAAI,CAACE,SAAL,EAArB;AACA,QAAMC,QAAQ,GAAG,MAAMF,MAAM,CAACG,UAAP,EAAvB;AACA,QAAM0B,aAAa,GAAG,MAAMjC,gBAAgB,CAACG,IAAD,CAA5C;AAEA,QAAMiB,OAAO,GAAG;AACdV,IAAAA,QAAQ,EAAEd,MAAM,CAACsC,KAAP,CAAaC,UAAb,CAAwB,IAAxB,EAA8B,MAA9B;AADI,GAAhB;AAGA,QAAMC,QAAQ,GAAG,MAAMH,aAAa,CAAC;AACnCR,IAAAA,OADmC;AAEnCC,IAAAA,QAFmC;AAGnCE,IAAAA,cAHmC;AAInCC,IAAAA,OAJmC;AAKnCC,IAAAA,WALmC;AAMnCC,IAAAA,WANmC;AAOnCJ,IAAAA,KAPmC;AAQnCK,IAAAA,YARmC;AASnCZ,IAAAA;AATmC,GAAD,CAApC;AAWA,QAAMgB,QAAQ,CAACvB,IAAT,EAAN;AACD,CA9BM","sourcesContent":["import { ethers } from \"ethers\";\nimport { addresses } from \"@gelato-krystal/contracts\";\nimport { getGasNowGasPrice } from \"../utils/helpers\";\nimport { getUserProxyContract, getGelatoKrystal } from \"./stateReads\";\n\nconst { INSTA_INDEX_ADDR } = addresses;\n\nexport const deployProxyAction = async (user) => {\n  const signer = await user.getSigner();\n  const userAddr = await signer.getAddress();\n  const instaIndexContract = new ethers.Contract(\n    INSTA_INDEX_ADDR,\n    [\n      \"function build(address _owner, uint accountVersion, address _origin) returns (address _account)\",\n    ],\n    signer\n  );\n  const gasPrice = await getGasNowGasPrice();\n  const tx = await instaIndexContract.build(userAddr, 1, userAddr, {\n    gasPrice: gasPrice,\n  });\n  await tx.wait();\n};\n\nexport const userProxyCast = async (\n  targets,\n  datas,\n  user,\n  val = 0,\n  gasLimit = 5000000\n) => {\n  const signer = await user.getSigner();\n  const userAddr = await signer.getAddress();\n  const userProxy = await getUserProxyContract(user);\n  const options = {\n    gasLimit: gasLimit,\n    value: val,\n  };\n  const castTx = await userProxy.cast(targets, datas, userAddr, options);\n  await castTx.wait();\n};\n\nexport const submitOrder = async (\n  user,\n  inToken,\n  outToken,\n  delay,\n  amountPerTrade,\n  nTrades,\n  minSlippage = 9001,\n  maxSlippage = 9000,\n  gasPriceCeil = 0\n) => {\n  const signer = await user.getSigner();\n  const userAddr = await signer.getAddress();\n  const gelatoKrystal = await getGelatoKrystal(user);\n\n  const options = {\n    gasPrice: ethers.utils.parseUnits(\"50\", \"gwei\"),\n  };\n  const submitTx = await gelatoKrystal({\n    inToken,\n    outToken,\n    amountPerTrade,\n    nTrades,\n    minSlippage,\n    maxSlippage,\n    delay,\n    gasPriceCeil,\n    options,\n  });\n  await submitTx.wait();\n};\n"]},"metadata":{},"sourceType":"module"}