{"ast":null,"code":"var _jsxFileName = \"/Users/Hilmar/code/integrations/krystal/gelato-krystal/packages/react-app/src/pages/SubmitTask.js\";\nimport React, { useState, useEffect } from \"react\";\nimport { ethers } from \"ethers\";\nimport { ViewCard, CardWrapper, Button } from \"../components\";\nimport { getVault, getUserProxy } from \"../services/stateReads\";\nimport { submitOrder } from \"../services/stateWrites\";\nimport { addresses } from \"@gelato-krystal/contracts\";\nimport { submitRefinanceMakerToMaker } from \"../services/payloadGeneration\";\nconst {\n  DAI,\n  USDC\n} = addresses;\n\nconst SubmitTask = ({\n  userAccount\n}) => {\n  const [loading, setLoading] = useState(false);\n  const [inputs, setInputs] = useState({});\n  const [totalAmount, setTotalAmount] = useState(30);\n  const [intervalSeconds, setIntervalSeconds] = useState(120);\n  const [tradeNum, setTradeNum] = useState(3); // const inputsUpdates = async () => {\n  //   const userProxy = await getUserProxy(userAccount);\n  //   const vA = await getVault(userAccount, userProxy, \"ETH-A\");\n  //   const vAId = vA !== undefined ? vA.id : 0;\n  //   const vB = await getVault(userAccount, userProxy, \"ETH-B\");\n  //   const vBId = vB !== undefined ? vB.id : 0;\n  //   setInputs({\n  //     ...inputs,\n  //     vaultAId: vAId,\n  //     vaultBId: vBId,\n  //     defaultValueAmount: 30,\n  //     defaultValueInterval: 120,\n  //     defaultValueTradeNum: 3,\n  //   });\n  // };\n\n  const handleTotalAmountChange = async event => {\n    const newValue = event.target.value;\n    setTotalAmount(newValue);\n  };\n\n  const handleIntervalSecondsChange = async event => {\n    const newValue = event.target.value;\n    setIntervalSeconds(newValue);\n  };\n\n  const handleTradeNumChange = async event => {\n    const newValue = event.target.value;\n    setTradeNum(newValue);\n  };\n\n  const submit = async () => {\n    if (totalAmount === 0) return;\n    if (intervalSeconds === 0) return;\n    if (parseInt(inputs.tradeNum) > 10) return;\n    await submitOrder(userAccount, DAI, USDC, intervalSeconds, totalAmount / tradeNum, tradeNum);\n  }; // useEffect(() => {\n  //   inputsUpdates();\n  // });\n\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(CardWrapper, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(ViewCard, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    style: {\n      margin: \"10px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 11\n    }\n  }, \"Total Amount of DAI to sell for USDC\"), /*#__PURE__*/React.createElement(\"input\", {\n    style: {\n      maxWidth: \"80%\"\n    },\n    type: \"number\",\n    value: totalAmount,\n    onChange: handleTotalAmountChange,\n    defaultValueAmount: inputs.defaultValueAmount,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(ViewCard, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    style: {\n      margin: \"10px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 11\n    }\n  }, \"Interval between each trade (in seconds)\"), /*#__PURE__*/React.createElement(\"input\", {\n    style: {\n      maxWidth: \"80%\"\n    },\n    type: \"number\",\n    value: intervalSeconds,\n    onChange: handleIntervalSecondsChange,\n    defaultValueAmount: inputs.defaultValueInterval,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(ViewCard, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    style: {\n      margin: \"10px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 11\n    }\n  }, \"Number of trades to split the total amount up\"), /*#__PURE__*/React.createElement(\"input\", {\n    style: {\n      maxWidth: \"80%\"\n    },\n    type: \"number\",\n    value: tradeNum,\n    onChange: handleTradeNumChange,\n    defaultValueAmount: inputs.defaultValueTradeNum,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(ViewCard, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 9\n    }\n  }, !loading && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"label\", {\n    style: {\n      margin: \"10px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 15\n    }\n  }, `Execute ${tradeNum} trades, each worth ${parseFloat(totalAmount / tradeNum).toFixed(3)} DAI`), /*#__PURE__*/React.createElement(Button, {\n    onClick: async () => {\n      setLoading(true);\n\n      try {\n        await submit();\n        setLoading(false);\n      } catch {\n        setLoading(false);\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 15\n    }\n  }, `Submit Task`)), loading && /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 23\n    }\n  }, \"waiting...\"))));\n};\n\nexport default SubmitTask;","map":{"version":3,"sources":["/Users/Hilmar/code/integrations/krystal/gelato-krystal/packages/react-app/src/pages/SubmitTask.js"],"names":["React","useState","useEffect","ethers","ViewCard","CardWrapper","Button","getVault","getUserProxy","submitOrder","addresses","submitRefinanceMakerToMaker","DAI","USDC","SubmitTask","userAccount","loading","setLoading","inputs","setInputs","totalAmount","setTotalAmount","intervalSeconds","setIntervalSeconds","tradeNum","setTradeNum","handleTotalAmountChange","event","newValue","target","value","handleIntervalSecondsChange","handleTradeNumChange","submit","parseInt","margin","maxWidth","defaultValueAmount","defaultValueInterval","defaultValueTradeNum","parseFloat","toFixed"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { ethers } from \"ethers\";\nimport { ViewCard, CardWrapper, Button } from \"../components\";\nimport { getVault, getUserProxy } from \"../services/stateReads\";\nimport { submitOrder } from \"../services/stateWrites\";\nimport { addresses } from \"@gelato-krystal/contracts\";\nimport { submitRefinanceMakerToMaker } from \"../services/payloadGeneration\";\nconst { DAI, USDC } = addresses;\n\nconst SubmitTask = ({ userAccount }) => {\n  const [loading, setLoading] = useState(false);\n  const [inputs, setInputs] = useState({});\n  const [totalAmount, setTotalAmount] = useState(30);\n  const [intervalSeconds, setIntervalSeconds] = useState(120);\n  const [tradeNum, setTradeNum] = useState(3);\n\n  // const inputsUpdates = async () => {\n  //   const userProxy = await getUserProxy(userAccount);\n  //   const vA = await getVault(userAccount, userProxy, \"ETH-A\");\n  //   const vAId = vA !== undefined ? vA.id : 0;\n  //   const vB = await getVault(userAccount, userProxy, \"ETH-B\");\n  //   const vBId = vB !== undefined ? vB.id : 0;\n\n  //   setInputs({\n  //     ...inputs,\n  //     vaultAId: vAId,\n  //     vaultBId: vBId,\n  //     defaultValueAmount: 30,\n  //     defaultValueInterval: 120,\n  //     defaultValueTradeNum: 3,\n  //   });\n  // };\n\n  const handleTotalAmountChange = async (event) => {\n    const newValue = event.target.value;\n    setTotalAmount(newValue);\n  };\n\n  const handleIntervalSecondsChange = async (event) => {\n    const newValue = event.target.value;\n    setIntervalSeconds(newValue);\n  };\n\n  const handleTradeNumChange = async (event) => {\n    const newValue = event.target.value;\n    setTradeNum(newValue);\n  };\n\n  const submit = async () => {\n    if (totalAmount === 0) return;\n    if (intervalSeconds === 0) return;\n    if (parseInt(inputs.tradeNum) > 10) return;\n\n    await submitOrder(\n      userAccount,\n      DAI,\n      USDC,\n      intervalSeconds,\n      totalAmount / tradeNum,\n      tradeNum\n    );\n  };\n\n  // useEffect(() => {\n  //   inputsUpdates();\n  // });\n\n  return (\n    <>\n      <CardWrapper>\n        <ViewCard>\n          <label style={{ margin: \"10px\" }}>\n            Total Amount of DAI to sell for USDC\n          </label>\n\n          <input\n            style={{ maxWidth: \"80%\" }}\n            type=\"number\"\n            value={totalAmount}\n            onChange={handleTotalAmountChange}\n            defaultValueAmount={inputs.defaultValueAmount}\n          />\n        </ViewCard>\n\n        <ViewCard>\n          <label style={{ margin: \"10px\" }}>\n            Interval between each trade (in seconds)\n          </label>\n\n          <input\n            style={{ maxWidth: \"80%\" }}\n            type=\"number\"\n            value={intervalSeconds}\n            onChange={handleIntervalSecondsChange}\n            defaultValueAmount={inputs.defaultValueInterval}\n          />\n        </ViewCard>\n\n        <ViewCard>\n          <label style={{ margin: \"10px\" }}>\n            Number of trades to split the total amount up\n          </label>\n\n          <input\n            style={{ maxWidth: \"80%\" }}\n            type=\"number\"\n            value={tradeNum}\n            onChange={handleTradeNumChange}\n            defaultValueAmount={inputs.defaultValueTradeNum}\n          />\n        </ViewCard>\n\n        <ViewCard>\n          {!loading && (\n            <>\n              <label style={{ margin: \"10px\" }}>\n                {`Execute ${tradeNum} trades, each worth ${parseFloat(\n                  totalAmount / tradeNum\n                ).toFixed(3)} DAI`}\n              </label>\n              <Button\n                onClick={async () => {\n                  setLoading(true);\n                  try {\n                    await submit();\n                    setLoading(false);\n                  } catch {\n                    setLoading(false);\n                  }\n                }}\n              >\n                {`Submit Task`}\n              </Button>\n            </>\n          )}\n          {loading && <p>waiting...</p>}\n        </ViewCard>\n      </CardWrapper>\n    </>\n  );\n};\n\nexport default SubmitTask;\n"]},"metadata":{},"sourceType":"module"}